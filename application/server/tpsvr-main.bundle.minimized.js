!function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[a]={exports:{}};t[a][0].call(u.exports,(function(e){return o(t[a][1][e]||e)}),u,u.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){(function(n){(function(){var r=e("fs"),o=e("path"),i={},a={},s=function(){var e,t=[];for(e in i)t[t.length]=i[e].path;t.sort();var o=n+"/../../../output";r.existsSync(o)||r.mkdirSync(o),r.writeFileSync(o+"/project-list.json",JSON.stringify(t,null,"\t"))},l=function(t,n){if(!t)return Error("empty project path");var l,c=(t=o.normalize(t.replace(/[\\\/]+$/,""))).toUpperCase();if(c in a)return Error("project duplicated, "+a[c]);if(!r.existsSync(t+"/package.json"))return Error("unfound project config");try{l=e(t+"/package.json")}catch(e){}if(!l)return Error("fail to load project config");for(var u=l.name,p=2;u in i;)u=l.name+"-"+p,p++;return i[u]={name:u,path:t,config:l},a[c]=u,n||s(),i[u]};t.exports={data:i,add:l,remove:function(e,t){if(t){if(!((r=e)in i))return Error("project name unfound, "+r);var n=i[r].path.toUpperCase()}else{if(!((n=(e=o.normalize(e.replace(/[\\\/]+$/,""))).toUpperCase())in a))return Error("project unfound");var r=a[n]}return delete i[r],delete a[n],s(),r},exists:function(e){if(!e)return Error("empty project path");var t=(e=o.normalize(e.replace(/[\\\/]+$/,""))).toUpperCase();return a[t]||""},save:s,load:function(){var t=o.normalize(n+"/../../../output/project-list.json");if(r.existsSync(t)){var i,a,s;try{i=e(t)}catch(e){return void console.log("load project list fail",t,e)}if(i)for(a=0;a<i.length;a++)try{(s=l(i[a],!0))instanceof Error?console.log("load project fail",i[a],s.message):console.log("load project from "+i[a])}catch(e){console.log("load project fail",i[a],e)}}}}}).call(this)}).call(this,e("path").join(__dirname,"lib"))},{undefined:void 0}],2:[function(e,t,n){(function(n){(function(){var r=e("path"),o=e(10),i=e(13),a=e(17),s=e(7),l=e(3),c=e(1),u=null,p=new a.class((function(){u=s([i.defaultEventEmitter,"state-change"],l.long_poll_state_delay,u,l.long_poll_state_delay+3e3)})),d={version:{}};var f=function(){d&&(d.data=null),p.update("sys",{dirname:r.normalize(n+"/.."),server_file_exec:l.extension_server_file_exec,platform:process.platform})};f();var h=function(){!function(e){d&&(d.data=null);var t=o.spawnItem(e),n={};for(var r in t)t[r]&&(n[r]=1);p.update(e,n)}("bundle")};h();t.exports={versionState:p,getLongPollState:function(){if(d.data)return d;var e=p.getDiff(d.version);return Object.assign(d.version,e.version),d.data=e.data,d},updateSys:f,updateBundle:h,updateProjects:function(){d&&(d.data=null);var e={};for(var t in c.data)e[t]=1;p.update("projects",e)}}}).call(this)}).call(this,e("path").join(__dirname,"lib"))},{1:1,10:10,13:13,17:17,3:3,7:7,undefined:void 0}],3:[function(e,t,n){t.exports=e("./tpsvr-config.js")},{undefined:void 0}],4:[function(e,t,n){(function(n){(function(){var r=e("url"),o=e("fs"),i=e("path"),a=e(14),s=e(10),l=e(13),c=e(18),u=e(1),p=e(2),d=e("child_process"),f=process.platform.match(/^win/i)?"bat":"sh",h=function(e,t,n){return t&&console.log(t.message||t),a.errorOrData(e,t,n),!0};var m=/^\/bundle-client(\.[\w\-]+)?\.js$/;function v(e,t){return o.stat(t,((n,r)=>{h(e,n,n?"":"result file, "+r.size+" bytes,\n"+i.normalize(t))})),!0}var g={getVersion:function(e,t,n){var r=u.exists(decodeURIComponent(e.reqUrl.query.cwd));return r=!r||r instanceof Error?0:1,h(t,null,c.name+", "+c.version+(n.bundle_ver?", "+n.bundle_ver.replace(/^\.+/,""):"")+", cwd="+r)},stopTpsvr:function(e,t,n){return a.text(t,"tpsvr stopping ..."),setTimeout((function(){process.ppid&&"by-supervisor"in n&&(console.log("killing parent process ..."),process.kill(process.ppid)),process.exit(0)}),200),!0},addProject:function(e,t,n){var r=u.add(decodeURIComponent(e.reqUrl.query.path));return!r||r instanceof Error?h(t,r||"add project fail"):(console.log("add project "+r.name+", "+r.path),p.updateProjects(),h(t,null,r))},removeProject:function(e,t,n){var r;return e.reqUrl.query.path?r=u.remove(decodeURIComponent(e.reqUrl.query.path)):e.reqUrl.query.name&&(r=u.remove(decodeURIComponent(e.reqUrl.query.name),!0)),!r||r instanceof Error?h(t,r||"remove project fail"):(s.remove(["bundle",r]),p.updateProjects(),h(t,null,r))},listProject:function(e,t,n){var r=e.reqUrl.query.project;return r?r in u.data?h(t,null,u.data[r]):h(t,"project unfound, "+r):h(t,null,u.data)},startBundle:function(e,t,r){var a=decodeURIComponent(e.reqUrl.query.project),l=u.data[a];if(!l)return h(t,"project unfound, "+a);var c=l.path+"/test/test-bundle."+f,d=null,m=!1;if(!o.existsSync(c)){if(!o.existsSync(l.path+"/test/test-data.js"))return h(t,"files unfound, test-bundle."+f+", test-data.js, "+a);m=!0,o.existsSync(l.path+"/test")||o.mkdirSync(l.path+"/test"),o.existsSync(l.path+"/test/bundle")||o.mkdirSync(l.path+"/test/bundle"),c=i.normalize(n+"/../node_modules/.bin/watchify"),d=["-v ","-o",l.path+"/test/bundle/test-bundle.js","-g","[ stringify --extensions [.html .css .htm ] ]","-r",l.path+"/package.json:_package_json","-r",l.path+"/test/test-data.js:_test_data","-r",l.path+"/"+l.config.main+":"+a]}var v=s.start(["bundle",a],c,d,{shell:m,keepHistoryConsole:!0},(function(e){p.updateBundle()}));return h(t,!v||v instanceof Error?v||"start bundle fail":null,!!v)},stopBundle:function(e,t,n){var r=decodeURIComponent(e.reqUrl.query.project),o=s.stop(["bundle",r]);return h(t,!o||o instanceof Error?o||"stop bundle fail":null,o)},viewConsole:function(e,t,n){var r=decodeURIComponent(e.reqUrl.query.project),o=["bundle",r],i="1"==e.reqUrl.query.history;"1"==e.reqUrl.query.clearHistory&&s.historyConsole(o,null);var l=s.getConsole(o,i);if(l instanceof Error)return h(t,l||"get console fail");if(null===l&&!i&&(i=!0,(l=s.getConsole(o,i))instanceof Error))return h(t,l||"get history console fail");var c=!0;null===l?l="(not exists, ["+o+"])":l?c=!1:l="(void, ["+o+"])";var u=["<div style='font-size:9pt;'>",i&&!c?"<a style='float:right;' href='/?cmd=viewConsole&project="+encodeURIComponent(r)+"&clearHistory=1'>[clear history]</a><br>":"",i?"":"<a style='float:right;' href='/?cmd=viewConsole&project="+encodeURIComponent(r)+"&history=1'>[history]</a><br>",l.replace(/^\s+/,"").replace(/\n\n\n+/g,"\n\n").replace(/\n/g,"<br>"),"</div>"];return a.text(t,u.join(""),null,{"Content-Type":"text/html;charset=UTF-8"}),!0},getLongPollState:function(e,t,n){if("1"==e.reqUrl.query.current)l.getCurrent(t,p.versionState.getDiff());else if(e.reqUrl.query.state_version){var r=decodeURIComponent(e.reqUrl.query.state_version);try{r=JSON.parse(r)}catch(e){return h(t,"state version fail, "+e.message)}var o=p.versionState.getDiff(r);o.data?l.getCurrent(t,JSON.stringify(o)):l(t,p.getLongPollState)}else l(t,p.getLongPollState);return!0},createTestData:function(e,t,r){var i=decodeURIComponent(e.reqUrl.query.project),a=u.data[i];if(!a)return h(t,"project unfound, "+i);if(o.existsSync(a.path+"/test/test-data.js"))return h(t,"file already exists, test/test-data.js, "+i);var s=o.readFileSync(n+"/../client/root/res/test-data-template.js","utf-8");return s=s.replace(/package-main-file/g,a.config.main).replace(/package_name_var/g,a.config.name.replace(/\W/g,"_")),o.existsSync(a.path+"/test")||o.mkdirSync(a.path+"/test"),o.writeFileSync(a.path+"/test/test-data.js",s),v(t,a.path+"/test/test-data.js")},createTestHtm:function(e,t,r){var i=decodeURIComponent(e.reqUrl.query.project),a=u.data[i];return a?o.existsSync(a.path+"/test/test.htm")?h(t,"file already exists, test/test.htm, "+i):(o.existsSync(a.path+"/test")||o.mkdirSync(a.path+"/test"),o.copyFileSync(n+"/../client/root/res/test-template.htm",a.path+"/test/test.htm"),v(t,a.path+"/test/test.htm")):h(t,"project unfound, "+i)},createBundleTool:function(e,t,r){var a=decodeURIComponent(e.reqUrl.query.project),s=u.data[a];if(!s)return h(t,"project unfound, "+a);var l=s.path+"/test/test-bundle."+f;if(o.existsSync(l))return h(t,"file already exists, test/test-bundle."+f+", "+a);var c=o.readFileSync(n+"/res/test-bundle-template."+f,"utf-8");return c=c.replace(/\%tpsvrPath\%/g,i.normalize(n+"/..")).replace(/\%moduleName\%/g,s.config.name).replace(/\%moduleMainFile\%/g,s.config.main),"bat"===f&&(c=c.replace(/(\r\n|\n\r|\n|\r)/g,"\r\n")),o.existsSync(s.path+"/test")||o.mkdirSync(s.path+"/test"),o.writeFileSync(l,c,"utf8"),"sh"===f&&d.exec("chmod +x "+l,((e,t)=>{e&&console.log(e)})),v(t,l)},tryMinimizeBundle:function(e,t,r){var a=decodeURIComponent(e.reqUrl.query.project),l=u.data[a];if(!l)return h(t,"project unfound, "+a);var c=l.path+"/test/main-minimize."+f,p=null,d=!0,m=!1;o.existsSync(c)||(d=!1,m=!0,o.existsSync(l.path+"/test")||o.mkdirSync(l.path+"/test"),o.existsSync(l.path+"/test/bundle")||o.mkdirSync(l.path+"/test/bundle"),c=i.normalize(n+"/../node_modules/.bin/browserify"),p=["-v ","-o",l.path+"/test/bundle/main-bundle-minimized.js","-p","bundle-collapser/plugin","-g","[ browserify-stringify-minimize-css-content --minimizeExtensions [ .css ] ]","-g","[ stringify --extensions [.html .css .htm ] --minify true ]","-r",l.path+"/"+l.config.main+":"+a]);var g=["minimize",a],y=s.start(g,c,p,{shell:m,keepHistoryConsole:!0},(function(e){if("exit"==e){var r=s.historyConsole(g);if(r&&s.historyConsole(["bundle",a],r),s.remove(g),d)return void v(t,l.path+"/test/bundle/main-bundle-minimized.js");if(c=i.normalize(n+"/../node_modules/.bin/terser"),p=[l.path+"/test/bundle/main-bundle-minimized.js","-o",l.path+"/test/bundle/main-bundle-minimized.js","-c","-m"],y=s.start(g,c,p,{shell:m,keepHistoryConsole:!0},(function(e){if("exit"==e){var n=s.historyConsole(g);n&&s.historyConsole(["bundle",a],n),s.remove(g),v(t,l.path+"/test/bundle/main-bundle-minimized.js")}})),y instanceof Error)return h(t,y||"start minimize bundle fail, terser")}}));return!(y instanceof Error)||h(t,y||"start minimize bundle fail, browserify")},createMiniBundleTool:function(e,t,r){var a=decodeURIComponent(e.reqUrl.query.project),s=u.data[a];if(!s)return h(t,"project unfound, "+a);var l=s.path+"/test/main-minimize."+f;if(o.existsSync(l))return h(t,"file already exists, test/main-minimize."+f+", "+a);var c=o.readFileSync(n+"/res/main-minimize-template."+f,"utf-8");return c=c.replace(/\%tpsvrPath\%/g,i.normalize(n+"/..")).replace(/\%moduleName\%/g,s.config.name).replace(/\%moduleMainFile\%/g,s.config.main),"bat"===f&&(c=c.replace(/(\r\n|\n\r|\n|\r)/g,"\r\n")),o.existsSync(s.path+"/test")||o.mkdirSync(s.path+"/test"),o.writeFileSync(l,c,"utf8"),"sh"===f&&d.exec("chmod +x "+l,((e,t)=>{e&&console.log(e)})),v(t,l)},loadPackage:function(e,t,n){for(var r,s,l=decodeURIComponent(e.reqUrl.query.name),c=decodeURIComponent(e.reqUrl.query.path),u=!1;!o.existsSync(s=c+"/node_modules/"+l+"/package.json");){if(!(r=i.normalize(c+"/.."))||r==c||r.length>=c.length){u=!0;break}c=r}if(u)return a.error(t,"unfound, "+l,404),!0;t.setHeader("package-path",encodeURIComponent(s));var p=Object.create(n);return p.filePath=s,p.isRoot=!1,n.default_process(e,t,p),!0}},y=!1;t.exports=function(e,t,s){y||(u.load(),y=!0,p.updateProjects()),t.setHeader("Access-Control-Allow-Origin","*"),t.setHeader("Access-Control-Allow-Methods","GET"),t.setHeader("Access-Control-Allow-Headers","x-requested-with,content-type");var l=e.reqUrl=r.parse(e.url,!0),c=decodeURIComponent(l.pathname).match(/^\/([^\*\/]+)\/\*\/(.*$)/);if(c)return function(e,t,r,s,l){var c=u.data[e];if(!c)return h(s,"project unfound, "+e);var p=Object.create(l);if(p.filePath=c.path+"/"+t,p.isRoot=p.filePath.replace(/[\\\/]+$/,"")==c.path,"test/test.htm"===t&&!o.existsSync(p.filePath)){if(!o.existsSync(i.dirname(p.filePath)+"/test-data.js"))return a.text(s,"(file not exists, 'test/test-data.js', project "+e+")");p.filePath=n+"/../client/root/res/test-template.htm"}l.default_process(r,s,p)}(c[1],c[2],e,t,s),!0;if(l.pathname&&l.pathname.match(m))return function(e,t,r){var i=e.reqUrl.pathname.match(m);if(!i)return a.error(t,"unfound client bundle, "+e.reqUrl.pathname,404),!0;var s=Object.create(r);return s.filePath=n+"/../client/root/bundle-client.debug"+(i[1]||"")+".js",o.existsSync(s.filePath)||(s.filePath=n+"/../client/root/bundle-client.minimized"+(i[1]||"")+".js"),s.isRoot=!1,r.default_process(e,t,s),!0}(e,t,s);if("/"===l.pathname){var d=l.query;if(!d||!d.cmd){var f=Object.create(s);return f.filePath=n+"/../client/root/index.html",s.default_process(e,t,f)}return d.cmd in g?(console.log("cmd="+d.cmd+", "+decodeURIComponent(l.search)),g[d.cmd](e,t,s)):h(t,"cmd unfound, "+d.cmd)}}}).call(this)}).call(this,e("path").join(__dirname,"."))},{1:1,10:10,13:13,14:14,18:18,2:2,undefined:void 0}],5:[function(e,t,n){(function(t){(function(){var n=e("fs"),r=e("path"),o=e(9),i=e(6),a=e(3),s=e(4),l=i({},null,null);l.cwd&&(l=i({},null,l.cwd));var c,u=l.cwd||process.cwd();if(console.log(u,t),u!==t){var p=u+"/tpsvr-config.js";if(n.existsSync(p))try{console.log("try loading user config ..."),c=e(p)}catch(e){console.log("userConfig fail",e)}}var d=Object.assign({},a,c||{},l);d.extension&&d.extension instanceof Array?d.extension.push(s):d.extension=[s],d.root_path=r.normalize(t+"/../client/root"),o(d)}).call(this)}).call(this,e("path").join(__dirname,"."))},{3:3,4:4,6:6,9:9,undefined:void 0}],6:[function(require,module,exports){module.exports=function(target,argv,workPath,shortKey){var i,k,v;for(target||(target={}),argv||(argv=process.argv),workPath||!1===workPath||(workPath=process.cwd()),i=0;i<argv.length;i++){if("--"!==(k=argv[i]).slice(0,2)){if(!shortKey||!(k in shortKey))continue;k=shortKey[k]}else k=k.slice(2);!(v=argv[i+1])||"--"===v.slice(0,2)||shortKey&&v in shortKey?target[k]=null:("{"==v.charAt(0)&&"}"==v.slice(-1)?v=eval("("+v+")"):workPath&&v.match(/^\.\.?(\\|\/|$)/)&&(v=workPath+"/"+v),"config"===k?Object.assign(target,"string"==typeof v?require(v):v):target[k]=v,i++)}return target}},{}],7:[function(e,t,n){var r=new Map,o=function(e){if(r.has(e)){var t=r.get(e);return r.delete(e),t}};t.exports=n=function(e,t,n,i){var a,s,l;if(e instanceof Array&&(a=e[0],!(s=e[1])))throw"delaySetTimeout emitter fail, event name empty.";if(n&&(l=o(n),clearTimeout(n)),i){var c=(new Date).getTime()+i;(!l||c<l)&&(l=c)}if(l){var u=l-(new Date).getTime();u<t&&(t=u)}var p=arguments.length>4?Array.prototype.slice.call(arguments,4):null;return a&&(p||(p=[])).unshift(s),n=setTimeout((function(){o(n),a?a.emit.apply(a,p):p?e.apply(null,p):e()}),t),l&&r.set(n,l),n},n.clearFinalTime=o},{}],8:[function(e,t,n){t.exports={http_ip:"127.0.0.1",http_port:8070,mime:{"*":"text/plain",html:"text/html",htm:"text/html",jpg:"image/jpg",css:"text/css",js:"text/javascript",bat:"text/bat",txt:"text/plain",md:"text/x-markdown"},head_text:"<style>a{display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;text-decoration:none;}a:hover{text-decoration:underline;}div{column-width:10em;}</style>"}},{}],9:[function(e,t,n){var r=e("http"),o=e("fs"),i=e("path"),a=e(8),s=function(e,t,n){var{filePath:r,isRoot:a}=n;return r||(r=decodeURIComponent(new URL(e.url,"http://any/").pathname),console.log("browse: "+r),a="/"===r,r=n.root_path+r),r.match(/[\\\/]$/)?(o.readdir(r,{withFileTypes:!0},(function(e,r){if(e)return console.log(e),t.writeHead(500,{"Content-type":"text/plain;charset=UTF-8"}),void t.end(""+e);var o=r.map((e=>{var t=e.isDirectory()?"/":"";return"<a href='"+e.name+t+"'>"+t+e.name+"</a>"}));t.writeHead(200,{"Content-type":"text/html;charset=UTF-8"}),t.end(n.head_text+"<div>"+(a?"":"<a href='../'>/..</a>")+o.join("")+"</div>")})),!0):(o.readFile(r,(function(e,o){if(e)"ENOENT"===e.code?(t.writeHead(404,{"Content-type":"text/plain"}),t.end("404 NOT FOUND")):(console.log(e),t.writeHead(500,{"Content-type":"text/plain;charset=UTF-8"}),t.end(""+e));else{var a=n.mime;t.writeHead(200,{"Content-type":a[i.extname(r).toLowerCase().slice(1)]||a["*"]||"application/octet-stream"}),t.end(o)}})),!0)};t.exports=function(e){var t=Object.assign(Object.create(a),e||{});["mime"].map((n=>{t[n]=Object.assign(Object.create(a[n]),e&&e[n]||{})})),t.root_path||(t.root_path=process.cwd());var n=t.extension||[],o=t.extension_default_process||s;t.default_process=o,console.log("=".repeat(50)),console.log("http://"+t.http_ip+":"+t.http_port+", start at "+new Date),console.log("root: "+t.root_path),r.createServer((function(e,r){for(var i in n)if(n[i](e,r,t))return;o(e,r,t)})).listen(t.http_port,t.http_ip)}},{8:8,undefined:void 0}],10:[function(e,t,n){var r=e("path"),o=e("child_process"),i=e(12),a=e(16),s=e(11),l={},c={},u=function(e,t){return t?(t.nameList="string"==typeof e?[e]:e,i(l,e,t)):void 0===t?i(l,e):void i(l,e,t,!0)},p=function(e,t){var n=i(c,e);if(void 0===t)return n?n.toString():null;null===t?n&&n.clear():(n||i(c,e,n=a()),n.add(t))},d=function(e){var t=u(e);return t?(t.process.stdin.end(),s.kill(t.process.pid),!0):Error("spawn not exists, "+e)};t.exports={spawnData:l,spawnItem:u,historyConsole:p,start:function(e,t,n,i,s){var l=u(e);if(l){var c="spawn already started, "+e;return console.log(c),Error(c)}return i||(i={}),"cwd"in i||(i.cwd=r.dirname(t)),"shell"in i||(i.shell=!0),(l={console:a([t+(n?" ["+n.join(", ")+"]":""),""],{maxLineNumber:i.maxConsoleLineNumber}),commandPath:t,options:i}).process=o.spawn(t,n,i),l.process.stdout.on("data",(t=>{var n=t.toString();l.console.add(n),console.log(e+": "+n.replace(/\s+$/,""))})),l.process.stderr.on("data",(t=>{var n=t.toString();l.console.add(n,"stderr: "),console.error(e+", stderr: "+n.replace(/\s+$/,""))})),l.process.on("close",(t=>{console.log("spawn closed with code "+t+", pid="+l.process.pid+", "+e),i.keepHistoryConsole&&l&&l.console&&!l.console.isEmpty()&&(p(e,[""]),p(e,l.console),p(e,["-----(exited, ["+e+"])-----",""])),u(e,null),s&&s("exit")})),u(e,l),s&&s("start"),l},stop:d,remove:function(e){var t=u(e);return t&&t.options&&(t.options.keepHistoryConsole=!1),i(c,e,null,!0),d(e)},getConsole:function(e,t,n){return t&&"auto"!=t?p(e):(n||(n=u(e)),n?n.console?n.console.toString():null:t?p(e):null)}}},{11:11,12:12,16:16,undefined:void 0}],11:[function(e,t,n){var r=e("child_process"),o=e(16),i="win"===process.platform.slice(0,3),a=function(e,t){if("function"!=typeof t)throw Error("getPidDescendant require callback function");e||(e=i?0:1),e=e.toString();var n=i?r.spawn("wmic.exe",["PROCESS","GET","Name,ParentProcessId,ProcessId"]):r.spawn("ps",["-A","-o","ppid,pid,stat,comm"]),a=!0,s={},l=[],c=o((function(t){if(n&&t){var r=t.trim().split(/(\s+)/);if(a)a=!1;else{var o=i?[r[r.length-3],r[r.length-1],r.slice(0,-4).join("")]:[r[0],r[2],r.slice(6).join(""),r[4]],c=o[0];if(c!=o[1]){var u=c in s?s[c]:s[c]=[];u[u.length]=o}o[1]==e&&l.push(o)}}}));c.lineSplitter=/[\r\n]+/,n.stdout.on("data",(e=>{c.add(e.toString())})),n.stdout.on("close",(r=>{if(n){c.end();for(var o,i=l.length-1;e;)(o=s[e])&&Array.prototype.push.apply(l,o),i++,e=l[i]&&l[i][1];t(null,l)}}))};t.exports=n=a,n.COLUMN_COUNT=4,n.INDEX_PPID=0,n.INDEX_PID=1,n.INDEX_NAME=2,n.INDEX_STAT=3,n.kill=function(e,t){a(e,(function(e,n){if(e)console.log(e);else for(var r=0;r<n.length;r++)process.kill(n[r][1],t)}))}},{16:16,undefined:void 0}],12:[function(e,t,n){t.exports=function(e,t,n,r){"string"==typeof t&&(t=[t]);var o,i,a,s=t.length-1;for(o=0;o<s;o++)(a=e[i=t[o]])||(a=e[i]={}),e=a;if(!r)return void 0!==n?e[t[s]]=n:e[t[s]];delete e[t[s]]}},{}],13:[function(e,t,n){var r=e("events"),o=e(15),i=new r;function a(e,t,n){n||(n={}),n.ACTIVE_PULSE_SECONDS=n.ACTIVE_PULSE_SECONDS||20,n.ACTIVE_PULSE_SECONDS_DELAY=n.ACTIVE_PULSE_SECONDS_DELAY||35,n.ACTIVE_PULSE_MAX_COUNT=n.ACTIVE_PULSE_MAX_COUNT||1e3;var r=n.eventEmitter||i;console.log("state polling start"),e.setHeader("Connection","Keep-Alive"),e.setHeader("Keep-Alive","timeout="+n.ACTIVE_PULSE_SECONDS_DELAY),e.writeHead(200,{"Content-type":"text/plain;charset=UTF-8"}),e.write("/");var a=null,s=null,l=function(){if(a&&(clearTimeout(a),a=!1),s&&(r.removeListener("state-change",s),s=null),!e.writableEnded)try{e.end("\n"+o(t,n.userKey))}catch(e){}console.log("state polling finished")};e.setTimeout(1e3*n.ACTIVE_PULSE_SECONDS_DELAY,l),e.on("close",l),e.on("error",l);var c=0,u=function(){(a||null===a)&&(e.writableEnded||(e.write("/"),++c>n.ACTIVE_PULSE_MAX_COUNT?l():(a&&(clearTimeout(a),a=null),a=setTimeout(u,1e3*n.ACTIVE_PULSE_SECONDS))))};u(),s=l,r.once("state-change",s)}t.exports=n=a,n.longPollingState=a,n.defaultEventEmitter=i,n.getCurrent=function(e,t,n){var r=o(t,n&&n.userKey);e.writeHead(200,{"Content-type":"text/plain;charset=UTF-8"}),e.end("//\n"+r)}},{15:15,undefined:void 0}],14:[function(e,t,n){var r=function(e,t,n,r){e.writeHead(n||200,r||{"Content-Type":"text/plain;charset=UTF-8"}),e.end(t)},o=function(e,t,n,o){r(e,JSON.stringify(t),n,o||{"Content-Type":"text/json;charset=UTF-8"})},i=function(e,t,n,o){var i;i="object"!=typeof t?t:t instanceof Error?t.message:JSON.stringify(t),r(e,i,n||500,o)};t.exports={text:r,json:o,error:i,errorOrData:function(e,t,n,r,a){t?i(e,t,r,a):o(e,n,r,a)}}},{}],15:[function(e,t,n){t.exports=function(e){var t=typeof e;return"function"===t&&(t=typeof(e=e.apply(null,Array.prototype.slice.call(arguments,1)))),"string"===t?e:JSON.stringify(e)}},{}],16:[function(e,t,n){function r(e,t){!e||t||e instanceof Array||(t=e,e=null),this.lineArray=e||[];var n=typeof t;"function"===n?this.lineCallback=t:"number"===n?this.maxLineNumber=t:t&&(t.lineCallback&&(this.lineCallback=t.lineCallback),t.maxLineNumber&&(this.lineCallback=t.maxLineNumber))}r.prototype={lineArray:null,maxLineNumber:255,lastLinePrefix:"",lineCallback:null,lineSplitter:/\r\n|\n\r|\n|\r/,addText:function(e,t){t=t||"";var n=this.lineArray,r=this.lineCallback;n.length<1&&(n[0]=t,t&&(this.lastLinePrefix=t));var o=e.split(this.lineSplitter);t===this.lastLinePrefix?n[n.length-1]=n[n.length-1]+o[0]:(r&&r(n[n.length-1]),n[n.length]=t+o[0],this.lastLinePrefix=t);var i,a,s=o.length-1;if(s>0)for(r&&r(n[n.length-1]),i=1;i<=s;i++)n[n.length]=a=t?t+o[i]:o[i],r&&i!=s&&r(a);n.length>this.maxLineNumber&&n.splice(0,n.length-this.maxLineNumber)},addLine:function(e,t){e instanceof r?e=e.lineArray:e instanceof Array||(e=[e]),t=t||"";var n=this.lineArray,o=this.lineCallback;o&&n.length>0&&o(n[n.length-1]);for(var i,a=e.length-1,s=0;s<=a;s++)n[n.length]=i=t?t+e[s]:e[s],o&&s!=a&&o(i);(t||this.lastLinePrefix)&&(this.lastLinePrefix=t),n.length>this.maxLineNumber&&n.splice(0,n.length-this.maxLineNumber)},endLine:function(){return this.addLine("")},isEmpty:function(){return this.lineArray.length<1||1==this.lineArray.length&&!this.lineArray[0]},clear:function(){this.lineArray=[],this.lastLinePrefix=""},toString:function(){return this.lineArray.join("\n")},add:function(e,t){return"string"==typeof e?this.addText(e,t):this.addLine(e,t)}};var o={end:"endLine"};for(var i in o)r.prototype[i]=r.prototype[o[i]];t.exports=n=function(e,t){return new r(e,t)},n.class=r},{}],17:[function(e,t,n){var r=0,o=function(e){this.data={},this.version={},this.updateCallback=e};o.prototype={data:null,version:null,updateCallback:null,update:function(e,t){this.data[e]=t,this.version[e]=++r,this.updateCallback&&this.updateCallback(e,t,this.version[e])},getDiff:function(e){if(!e)return{data:this.data,version:this.version};var t,n={},r=0;for(t in this.version)e[t]!==this.version[t]&&(n[t]=this.data[t],r++);return r>0?{data:n,version:this.version}:{version:this.version}}},t.exports={class:o,debugResetSeed:function(){r=0}}},{}],18:[function(e,t,n){t.exports={name:"tpsvr",version:"1.0.1",description:"test page server",main:"application/server/tpsvr-main.js",scripts:{test:'echo "Error: no test specified" && exit 1'},keywords:["test","http","server"],author:"fwg",license:"ISC",bin:{tpsvr:"bin/cmd.js"},repository:{type:"git",url:"git+https://github.com/adf0001/tpsvr.git"},bugs:{url:"https://github.com/adf0001/tpsvr/issues"},homepage:"https://github.com/adf0001/tpsvr#readme",dependencies:{"@babel/core":"^7.17.5","@babel/plugin-transform-arrow-functions":"^7.16.7","@babel/plugin-transform-block-scoping":"^7.16.7","@babel/plugin-transform-classes":"^7.16.7","@babel/plugin-transform-destructuring":"^7.17.3","@babel/plugin-transform-for-of":"^7.16.7","@babel/plugin-transform-parameters":"^7.16.7","@babel/plugin-transform-regenerator":"^7.16.7","@babel/plugin-transform-shorthand-properties":"^7.16.7","@babel/plugin-transform-spread":"^7.16.7","@babel/plugin-transform-template-literals":"^7.16.7","argv-config":"^1.0.4",babelify:"^10.0.0","browserify-stringify-minimize-css-content":"^1.0.1","bundle-collapser":"^1.4.0","core-js":"^3.21.1","delay-set-timeout":"^1.0.2","easy-http-server":"^1.0.1","htm-tool":"^1.0.23","http-request-text":"^1.0.5","multiple-spawn":"^1.0.14","open-url-by-browser":"^1.0.1","package-json-data-set":"^1.0.2","package-json-explore-view":"^1.0.2","package-json-to-html":"^1.0.1","package-json-tool":"^1.0.1","package-json-version-tool":"^1.0.1","response-long-poll-state":"^1.0.4","response-tool":"^1.0.4",stringify:"^5.2.0",supervisor:"^0.12.0",terser:"^5.11.0","ui-model-treeview":"^1.0.1","version-value-set":"^1.0.2",watchify:"^4.0.0"},devDependencies:{}}},{}]},{},[5]);